Not ndc!
get rays
Traceback (most recent call last):
  File "main.py", line 780, in <module>
    train(args)
  File "main.py", line 531, in train
    rays = np.stack([get_rays_np(H, W, K, p) for p in poses[:,:3,:4]], 0) # [N, ro+rd, H, W, 3]
  File "<__array_function__ internals>", line 5, in stack
  File "/opt/conda/lib/python3.8/site-packages/numpy/core/shape_base.py", line 433, in stack
    return _nx.concatenate(expanded_arrays, axis=axis, out=out)
  File "<__array_function__ internals>", line 5, in concatenate
numpy.core._exceptions._ArrayMemoryError: Unable to allocate 5.72 GiB for an array with shape (400, 2, 800, 800, 3) and data type float32